<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="800" height="600" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="400" y="40" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#1f2937">
    Dremio Core Algorithms Architecture
  </text>
  
  <!-- Query Optimization Layer -->
  <g id="query-optimization">
    <rect x="50" y="80" width="200" height="120" rx="10" fill="#3b82f6" opacity="0.1" stroke="#3b82f6" stroke-width="2"/>
    <text x="150" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1f2937">
      Query Optimization
    </text>
    
    <!-- Cost-Based Optimizer -->
    <rect x="70" y="120" width="75" height="30" rx="5" fill="#60a5fa" opacity="0.8"/>
    <text x="107" y="138" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ffffff">
      CBO
    </text>
    
    <!-- Cardinality Estimation -->
    <rect x="155" y="120" width="75" height="30" rx="5" fill="#3b82f6" opacity="0.8"/>
    <text x="192" y="138" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ffffff">
      Cardinality
    </text>
    
    <!-- Predicate Pushdown -->
    <rect x="70" y="160" width="160" height="30" rx="5" fill="#1d4ed8" opacity="0.8"/>
    <text x="150" y="178" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ffffff">
      Predicate Pushdown
    </text>
  </g>
  
  <!-- Reflection Management Layer -->
  <g id="reflection-management">
    <rect x="300" y="80" width="200" height="120" rx="10" fill="#10b981" opacity="0.1" stroke="#10b981" stroke-width="2"/>
    <text x="400" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1f2937">
      Reflection Management
    </text>
    
    <!-- Recommendation Engine -->
    <rect x="320" y="120" width="80" height="30" rx="5" fill="#34d399" opacity="0.8"/>
    <text x="360" y="138" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ffffff">
      Recommend
    </text>
    
    <!-- Refresh Algorithm -->
    <rect x="410" y="120" width="80" height="30" rx="5" fill="#10b981" opacity="0.8"/>
    <text x="450" y="138" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ffffff">
      Refresh
    </text>
    
    <!-- Materialized Views -->
    <rect x="320" y="160" width="170" height="30" rx="5" fill="#059669" opacity="0.8"/>
    <text x="405" y="178" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ffffff">
      Materialized Views
    </text>
  </g>
  
  <!-- Distributed Execution Layer -->
  <g id="distributed-execution">
    <rect x="550" y="80" width="200" height="120" rx="10" fill="#f59e0b" opacity="0.1" stroke="#f59e0b" stroke-width="2"/>
    <text x="650" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1f2937">
      Distributed Execution
    </text>
    
    <!-- Fragment Scheduling -->
    <rect x="570" y="120" width="75" height="30" rx="5" fill="#fbbf24" opacity="0.8"/>
    <text x="607" y="138" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ffffff">
      Scheduling
    </text>
    
    <!-- Fault Tolerance -->
    <rect x="655" y="120" width="75" height="30" rx="5" fill="#f59e0b" opacity="0.8"/>
    <text x="692" y="138" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ffffff">
      Fault Tolerance
    </text>
    
    <!-- Load Balancing -->
    <rect x="570" y="160" width="160" height="30" rx="5" fill="#d97706" opacity="0.8"/>
    <text x="650" y="178" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ffffff">
      Load Balancing
    </text>
  </g>
  
  <!-- Performance Optimization Layer -->
  <g id="performance-optimization">
    <rect x="175" y="250" width="450" height="120" rx="10" fill="#8b5cf6" opacity="0.1" stroke="#8b5cf6" stroke-width="2"/>
    <text x="400" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1f2937">
      Performance Optimization
    </text>
    
    <!-- Memory Management -->
    <rect x="200" y="290" width="100" height="30" rx="5" fill="#a78bfa" opacity="0.8"/>
    <text x="250" y="308" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ffffff">
      Memory Mgmt
    </text>
    
    <!-- Cache Optimization -->
    <rect x="320" y="290" width="100" height="30" rx="5" fill="#8b5cf6" opacity="0.8"/>
    <text x="370" y="308" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ffffff">
      Cache Opt
    </text>
    
    <!-- Resource Allocation -->
    <rect x="440" y="290" width="100" height="30" rx="5" fill="#7c3aed" opacity="0.8"/>
    <text x="490" y="308" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ffffff">
      Resource Alloc
    </text>
    
    <!-- Vectorization -->
    <rect x="200" y="330" width="160" height="30" rx="5" fill="#6d28d9" opacity="0.8"/>
    <text x="280" y="348" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ffffff">
      SIMD Vectorization
    </text>
    
    <!-- Statistics Collection -->
    <rect x="380" y="330" width="160" height="30" rx="5" fill="#5b21b6" opacity="0.8"/>
    <text x="460" y="348" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ffffff">
      Statistics Collection
    </text>
  </g>
  
  <!-- Data Flow Arrows -->
  <g id="data-flow" stroke="#6b7280" stroke-width="2" fill="none" marker-end="url(#arrowhead)">
    <!-- Query Optimization to Reflection Management -->
    <path d="M 250 140 L 300 140"/>
    
    <!-- Reflection Management to Distributed Execution -->
    <path d="M 500 140 L 550 140"/>
    
    <!-- All upper layers to Performance Optimization -->
    <path d="M 150 200 L 280 250"/>
    <path d="M 400 200 L 400 250"/>
    <path d="M 650 200 L 520 250"/>
  </g>
  
  <!-- Mathematical Formulas -->
  <g id="formulas" font-family="Arial, sans-serif" font-size="12" fill="#374151">
    <text x="50" y="420" font-weight="bold">Key Mathematical Models:</text>
    
    <text x="70" y="445">• CBO: Cost(plan) = Σᵢ wᵢ × costᵢ(plan)</text>
    <text x="70" y="465">• Join Cardinality: |R ⋈ S| ≈ |R| × |S| × selectivity</text>
    <text x="70" y="485">• Reflection ROI: (Benefit - Cost) / Cost</text>
    <text x="70" y="505">• Fault Tolerance: P(failure) = 1 - e^(-nλt)</text>
    <text x="70" y="525">• Memory Allocation: max Σᵢ utility(aᵢ) s.t. Σᵢ aᵢ ≤ M</text>
  </g>
  
  <!-- Algorithm Complexity -->
  <g id="complexity" font-family="Arial, sans-serif" font-size="12" fill="#374151">
    <text x="450" y="420" font-weight="bold">Algorithmic Complexity:</text>
    
    <text x="470" y="445">• Join Optimization: O(3ⁿ)</text>
    <text x="470" y="465">• Predicate Pushdown: O(n × p)</text>
    <text x="470" y="485">• Reflection Selection: O(n² log n)</text>
    <text x="470" y="505">• Fault Recovery: O(log n)</text>
    <text x="470" y="525">• Memory Management: O(1)</text>
  </g>
  
  <!-- Performance Indicators -->
  <g id="performance" font-family="Arial, sans-serif" font-size="11" fill="#059669">
    <circle cx="70" cy="560" r="3" fill="#10b981"/>
    <text x="80" y="565">Query Acceleration: 10-100x</text>
    
    <circle cx="250" cy="560" r="3" fill="#10b981"/>
    <text x="260" y="565">Memory Efficiency: 2-10x</text>
    
    <circle cx="420" cy="560" r="3" fill="#10b981"/>
    <text x="430" y="565">Fault Recovery: &lt;1s</text>
    
    <circle cx="580" cy="560" r="3" fill="#10b981"/>
    <text x="590" y="565">SIMD Speedup: 4-8x</text>
  </g>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
            refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#6b7280"/>
    </marker>
  </defs>
</svg>